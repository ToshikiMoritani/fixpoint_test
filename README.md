# 株式会社フィックスポイント プログラミング試験

プログラミング言語はPython3を使用した。<br>
試験の解答となるコードは「fixpoint_test.py」に記述されている。<br>
プログラムの実行方法はGoogle Colaboratoryで新規ノートブックを作成し、fixpoint_test.pyのコードをコピー＆ペーストして実行すれば、Pythonを導入していないパソコンでも実行可能である。<br>
設定することを指示された以下の3つのパラメータ<br>
N：故障とみなす連続したタイムアウトの回数。また、あるサブネット内全て同時にN回以上タイムアウトしていると、サブネットの故障とみなす。<br>
m：平均応答時間計算に使う直近のデータ数。<br>
t：過負荷状態であると判断するping時間の閾値。<br>
はプログラムの上部にまとめてある。<br>
使用したテストデータは「test_data.csv」で確認できる。またテストデータの読み込みには、GitHub上に保存されているtest_data.csvをURLを基に読み込んでいる。<br>
テストデータを用いたプログラムの実行結果は「output.txt」で確認できる。<br>

## データの前処理
テストデータから、行名を日時、列名をサーバアドレス、値を応答時間の形に加工した表「test_data_mat」を作成。<br>
行名を日時、列名をサーバアドレス、値をその日時でに連続で応答がない回数を示した表「counter_mat」を作成。<br>

## 設問1：故障状態のサーバアドレスとそのサーバの故障期間を出力する。
counter_matを列（サーバ名）で順に参照していく。値に1が入力されているところの行名を故障開始時間に、またそれ以降0に切り替わったところを故障終了時刻と判定する。記録終了時刻にも応答がない場合は、その旨を出力する。<br>

## 設問2：N回以上連続してタイムアウトした場合にのみ故障とみなす。
counter_matを列（サーバ名）で順に参照していく。値にNが入力されているところの直前の1が入力されている行名を故障開始時間に、またそれ以降0に切り替わったところを故障終了時刻と判定する。記録終了時刻にも応答がない場合は、その旨を出力する。<br>

## 設問3：直近m回の平均応答時間がtミリ秒を超えた場合を、サーバが過負荷状態とする。
今回は「直近m回」を「自信を含めた直前m回」とし、また直近m回の中で1度でも応答がない場合はその時間は過負荷状態とした。<br>
各サーバについて、pingを行った時間ごとに直近m回の移動平均を計算したmoving_average_response_time_serieseを作成した。<br>
moving_average_response_time_serieseを列の上から順に参照し、移動平均の値がtを超えたところの行名を過負荷開始時間に、またそれ以降tを下回ったところを過負荷終了時刻と判定する。記録終了時刻にも過負荷状態が続いている場合は、その旨を出力する。<br>

## 設問4：あるサブネット内のサーバが全て故障（ping応答がすべてN回以上連続でタイムアウト）している場合は、そのサブネットの故障とみなす。
サブネット（サーバ名の"/"以下）を基にサーバ名を分類する。<br>
counter_matを基に、あるサブネットに属するサーバの連続で応答がない回数を示した表subnet_downstream_server_counter_matを作成。<br>
subnet_downstream_server_counter_matを上から順に参照し、横一列全ての値がN以上になったところの行名を故障開始時刻に、それ以降初めてひとつでも値が0になったところを故障終了時刻と判定する。記録終了時刻にも故障状態が続いている場合は、その旨を出力する。<br>
